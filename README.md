# Cosmonauts backend

## Dependencies:

- Ruby v3.3.0
- Bundler v2.5.4

## Local installation

These are the steps to run the project locally:

### Installing ruby dependencies

On the project's root run `bundle install`.

### Database

Project is using SQLite database

#### Create database schema

Run `bin/rails db:create db:migrate db:seed` to setup the database. Seeding creates 100_000 cosmonauts records (can take some time) which can be used later on to test export and import.

### Run the tests

`bundle exec rspec`

#### Manual tests

Project contains documentation generated by rswag gem. It can be accessed at `/api-docs` endpoint. All endpoints can be tested from there.

To test export and imports endpoints, first export data and check exported file. Then import the same file and check if data was imported correctly.

### Run rswag to generate API documentation

`SWAGGER_DRY_RUN=0 rake rswag:specs:swaggerize`

Documentation can be found at `/api-docs`.

### Replace snapshot files

On the first run, the `match_snapshot` matcher will always return success and it will store a snapshot file. On the next runs, it will compare the response with the file content.

If you need to replace snapshots, run the specs with:

`REPLACE_SNAPSHOTS=true bundle exec rspec`

If you only need to add, remove or replace data without replacing the whole snapshot:

`CONSERVATIVE_UPDATE_SNAPSHOTS=true bundle exec rspec`

### Run linters

`bin/rails standard`

To fix linter issues

`bin/rails standard:fix`